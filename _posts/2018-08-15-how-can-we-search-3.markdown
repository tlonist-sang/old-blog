---
layout: post
title:  "나는 어떻게 구글에서 자료를 찾을 수 있을까-3?"
date:   2018-08-15 00:45:22 +0900
categories: test1
---

#3. 

www.google.com url이 내 손을 떠나는 과정을 좀 더 자세히 추적해보자. [지난포스팅](http://tlonist.github.io/jekyll/update/2018/08/05/how-can-we-search-2.html)서는 www.google.com이라는 자연어가 실제 IP 주소로 변하는 과정을 살펴보았다. 그럼 IP란 무엇이고 DNS와 그 밖의 요소들을 한번쯤 훑고 실제 내 상황에 대입하여보자. 참고로 나의 포스팅들은 수많은 블로그들과 유튜브, 특히 [빡빡머리 엘리 더 컴퓨터가이]("https://www.youtube.com/watch?v=EkNq4TrHP_U&t=381s")가 많은 도움이 되고 있다. 아직은 댓글기능이 없어 틀린 지식을 전파하고 있을지 모른다는 불안감이 있는데, 계속 공부하면서 피드백도 받고 수정할 계획이다.
 
모든 활동은 네트워크 안에서 이뤄진다. 내 컴퓨터의 네트워크 환경을 좀 더 자세히 알아보자. 
IP는 Internet protocol의 약자이며, 흔히 IP가 뭐야?라고 했을때는 IP 주소를 묻는 경우가 많다. 네트워크 안에서 한 단말(end-device)이 다른 단말을 고유하게 인식하기 위해서는 이 IP 주소가 필요하다. 간단하게 말하면 서로를 식별하는 이름 같은 역할을 한다고 볼 수 있고, 네트워크 상의 모든 단말은 고유한(정확히는 식별가능한) IP 주소를 가지고 있어야 서로 대화가 가능하다.

![img]({{ "/assets/img/ipAddr.png" | absolute_url }})

내 컴퓨터의 IP주소등을 확인하는 간단한 방법은 바로 IPv4의 속성을 확인해보는 것이다. (필자는 명령>ncpa.cpl 로 그냥 한번에 들어가서 보는걸 선호한다)

![img]({{ "/assets/img/ipv4.png" | absolute_url }})

 
확인하려고 보니 ‘자동으로 IP 주소 받기’가 설정되어 있어 실제 주소를 알 수가 없었다. 이름과 같은 주소를 자동으로 받아온다? 이게 무슨 말일까. 이를 위해선 약간의 설명이 더 필요하다. 


![img]({{ "/assets/img/nonRoutable.png" | absolute_url }})
![img]({{ "/assets/img/routable.png" | absolute_url }})

IP 주소는 크게 Routable IP 주소와 Non-routable IP 주소로 나뉜다. Routable은 route+able(경로 설정 가능한) 이라는 뜻인데, 간단히 말해 라우터를 쓰는 IP주소라고 이해할 수도 있겠다. 
태초에 인터넷이 생긴 배경은 군사목적이었다. 즉, 폐쇄된 환경에서 단말끼리의 통신을 위한 목적으로 생겨난 인트라넷이 배경이었는데, 이 닫힌 시스템에서는 모든 단말들끼리 서로 연결된 그림-1과 같은 모습이었다.
하지만 인터넷이 보편화되고, 단말이 기하급수적으로 늘어나면서 다음과 같은 문제가 생겼다. [관련링크](
https://www.google.co.kr/search?ei=nNxzW-TrBpzm8wXSjaGYCg&q=when+to+use+non+routable+ip&oq=when+to+use+non+routable+ip&gs_l=psy-ab.3..33i160k1l2.1844.10303.0.10480.27.20.0.0.0.0.290.2901.0j8j7.15.0....0...1c.1.64.psy-ab..12.13.2501...0j35i39k1j0i67k1j0i203k1j0i10k1j33i22i29i30k1j33i21k1.0.ovZNJNjl_dg)
	
-	첫째, IP가 고갈될 수 있음 (단말간 식별 불가능 문제)
-	둘째, (중요) 인터넷 서비스 제공자의 역량을 벗어난 라우팅 오버헤드의 문제
 기기가 많아질수록 한 기기를 식별하기 위해 사용되는 컴퓨팅 파워가 늘어남
따라서 현재는 사설망(private network)을 제외한 모든 공용 인터넷은 서브네트워크의 집합으로 이루어져 있고, 이 서브네트워크끼리는 라우터를 통해 외부와 통신을 한다. 


![img]({{ "/assets/img/defaultGateway.png" | absolute_url }}) 

이 라우터가 다른 라우터와 통신할 때 사용하는 IP 주소가 바로 기본 게이트웨이(default Gateway)가 되는 것이다. 즉, 내가 구글을 검색했을 때, 컴퓨터는 제일 먼저 내가 속한 서브네트워크에 구글이 있나 확인할 것이고(물론 없을 것이다), 그 후에는 라우터를 통해 서브네트워크를 탈출하여 다른 네트워크에서 확인할 것이라는 이야기다.


![img]({{ "/assets/img/subnetMask.png" | absolute_url }})

그럼 그 위의 서브넷 마스크는 뭘까? 비트 마스킹(bit-masking)의 논리가 적용된 개념인데, 한마디로 말해 내가 위치한 서브넷에서 얼마나 많은 IP 주소가 생길 수 있나를 나타내는 지표다. 255를 이진수로 표현한 11111111과 AND 연산시 0인 부분에서 IP를 나눠쓴다는 개념으로 이해할 수 있다. 
대부분의 경우는 C 클래스 서브넷 마스크인 255.255.255.0으로 되어있다. 네 숫자로 이뤄진 IP의 첫 세부분은 전부 1로 채워져 있어 이용불가능하고, 마지막 자리만 00000000 이어서 총 2^8-2 개의 아이피를 사용할 수 있는 것이다. (두개는 서브넷 네트워크와 브로드캐스팅 주소에 할당)
이는 한 서브넷에서 253개의 아이피를 운용할 수 있다는 것인데, 만약 이 서브넷을 쪼개서 운용한다고 생각해보자. 8개의 비트중에서 네개를 사용하면 2^16-2 개의 호스트(단말)에 할당가능하고, 서브넷의 수는 8개 중 사용하지 않는 나머지 네개가 늘어서 2^4 = 16개가 되는 것이다. 중요한 것은, 이렇게 다중 네트워크로 구성될 경우, 물리적으로는 서로 연결되어 있더라도 각각의 서브넷끼리는 공유기로만 통신이 가능하다는 점이다. [서브넷 설명이 매우 훌륭하게 된 블로그의 링크](http://blog.naver.com/phoenix208/40044271679) 를 남긴다. 

![img]({{ "/assets/img/dhcp.png" | absolute_url }})

마지막으로는 ‘자동으로 할당하기’가 의문으로 남아있다. 매번 수동으로 IP 주소, 서브넷 마스크, 기본 게이트웨이를 입력하지 않고, DHCP(Dynamic Host Configuration Protocol)로 DHCP 서버에게 이 모든 정보를 받아오는 것이다. DHCP 서버는 DNS 서버와 함께 라우터안에 있다. 이렇게 할당받은 정보에는 임대기간이 있는데, 임대기간의 절반이 되는 시점에 계속 사용해도 되는 지의 여부를 물어본다. 만약 답변이 없으면 물어보는 주기는 반감된다(더 자주 물어보게 된다)
![img]({{ "/assets/img/dhcpLease.png" | absolute_url }})



좀더 실질적인 것으로 내려와서 컴퓨터 뒷면을 보면 이렇게 생겼고, 빨간 동그라미가 있는 곳에 랜선을 연결해서 인터넷에 연결한다는 정도는 누구나 알고 있다. 내 데스크탑 본체에 꽂힌 랜선은 다시 또 다른곳에 연결되어 있다. 바로 케이블 모뎀과 공유기이다. 이에 대한 이야기는 다음 포스팅으로.. 

[jekyll-docs]: https://jekyllrb.com/docs/home
[jekyll-gh]:   https://github.com/jekyll/jekyll
[jekyll-talk]: https://talk.jekyllrb.com/
